<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ggplot2 Tutorial • seizer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ggplot2 Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">seizer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ggplot2-tutorial.html">ggplot2 Tutorial</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cesaraustralia/seizer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ggplot2 Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cesaraustralia/seizer/vignettes/articles/ggplot2-tutorial.Rmd" class="external-link"><code>vignettes/articles/ggplot2-tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>ggplot2-tutorial.Rmd</code></div>
    </div>

    
    
<p>This article includes a brief explanation on how to use
<code>ggplot2</code>, and how to integrate the <strong>seizer</strong>
functions with it. This is far from an in-depth article, but it should
be enough for you to be able to generate some basic plots using
<code>ggplot2</code>. See the <a href="#further-reading">Further
reading</a> section if you want to dive deeper into the world of
<code>ggplot2</code>.</p>
<p>We’ll begin, always, by loading our packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexsla/seizer" class="external-link">seizer</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-grammar-of-graphics">The grammar of graphics<a class="anchor" aria-label="anchor" href="#the-grammar-of-graphics"></a>
</h2>
<p>The key to using <code>ggplot2</code> is understanding its syntax,
which is based on Hadley Wickham’s layered grammar of graphics
framework. If you want to read more about it, there are links in the <a href="#further-reading">Further reading</a> section. For our purposes
though, we’ll just focus on the components that make up a
<code>ggplot</code> object, and how we set it up. Here is a
representation of the structure of a <code>ggplot</code> object (adapted
from the <code>ggplot2</code> documentation):</p>
<p><img src="ggplot2-tutorial_files/figure-html/grammar-1.png" width="700"></p>
<p>As you can see, the key word in the layered grammar of graphics
behind <code>ggplot2</code> is <em>layered</em>. Each component is
passed separately to a function, and you add them to one another to
create a complete plot. We will explain how by recreating the following
figure stage by stage:</p>
<p><img src="ggplot2-tutorial_files/figure-html/ggplot%20cesar%20scale-1.png" width="700"></p>
<div class="section level3">
<h3 id="data">1. Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The basis of any plot is the data underlying it. Our data will
consist of a dataframe, of which we will want to visualise at least one
dimension, or column. For example, we can view the <code>iris</code>
dataset which comes together with <code>ggplot2</code> and has data of
sepal and petal dimensions for different species of iris flowers.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span></code></pre></div>
<p>Irises, by the way, are awesome and you should take this opportunity
to google some photos of irises. I’m a particular fan of <em>Iris
petrana</em>.</p>
<p>Anyway, moving on!</p>
<p>We can generate a <code>ggplot</code> object by passing data to the
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> function. This can be done either by
using the <code>data</code> argument in the <code>ggplot</code>
function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/data%201-1.png" width="700"></p>
<p>or by piping, if you’re comfortable using that functionality:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/data%202-1.png" width="700"></p>
<p>Note that in both cases, we end up with an empty plot. This is
because while we have provided <code>ggplot2</code> with the data, we
have not provided any other information on how to actually represent the
data in our plot. But we have created a <code>ggplot</code> object,
which we can now add more and more to using other functions.</p>
</div>
<div class="section level3">
<h3 id="mapping">2. Mapping<a class="anchor" aria-label="anchor" href="#mapping"></a>
</h3>
<p>The next step is to decide which dimension, or dimensions, we want to
plot. In other words, we define the axes of our plot, and whether any
dimensions are encoded to size, shape, colour, etc. This is done using
the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code> function, which defines a list of
aesthetic mappings, and is passed on to the <code>ggplot</code> object
using the <code>mapping</code> argument. This is how we translate the
data to the graphics system, by “mapping” a column (i.e., dimension of
data) onto a graphical element (aesthetic). So, for example, if we want
to plot petal length against sepal length, we pass these as our axes to
the <code>ggplot</code> object:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/aes-1.png" width="700"></p>
<p>Our plot is coming along - we now have axes, and we see that the
ranges on the axes correspond to the range of values in each column in
the dataframe. But the plot is still empty.</p>
</div>
<div class="section level3">
<h3 id="layers">3. Layers<a class="anchor" aria-label="anchor" href="#layers"></a>
</h3>
<p>Layers display the mapped data from the previous step in some kind of
graphical representation. To quote from the <code>ggplot</code>
documentation:</p>
<p><em>Every layer consists of three important parts:</em></p>
<ol style="list-style-type: decimal">
<li>
<em>The</em> <strong><em>geometry</em></strong> <em>that determines
how data are displayed, such as points, lines, or rectangles.</em>
</li>
<li>
<em>The</em> <strong><em>statistical</em></strong>
<em>transformation that may compute new variables from the data and
affect what of the data is displayed.</em>
</li>
<li>
<em>The</em> <strong><em>position</em></strong> <em>adjustment that
primarily determines where a piece of data is being displayed.</em>
</li>
</ol>
<p>Layers are constructed using either <code>geom_*()</code> or
<code>stat_*()</code> functions. We will focus here on geoms, which are
the geometric objects with which we want the data visualised. These can
be points, bars, lines, boxes, etc. There are many different geoms to
choose from - but some will not work with our data. For example, this
works fine:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/geom%201-1.png" width="700"></p>
<p>but this throws up an error:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `geom_bar()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Problem while computing stat.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Error occurred in the 1st layer.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in `setup_params()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> `stat_count()` must only have an <span style="color: #00BB00;">x</span> <span style="font-style: italic;">or</span> <span style="color: #00BB00;">y</span> aesthetic.</span></span></code></pre></div>
<p>You’ll notice the error mentions something called
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::stat_count()</a></code>. This is the statistical
transformation - which determines whether or not we want to show some
kind of statistical measure of our underlying data, for example a count.
But it could also be the mean, spread, confidence intervals, etc. All
geoms have underlying default <code>stat</code> values, which define the
statistical transformation to use on the data in this layer. But some
combinations just don’t make sense. So, our first attempt worked because
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point()</a></code> by default uses
<code>stat = "identity"</code> - which means the data are not
transformed, and each datum is shown as a point with an x and a y
coordinate. But, <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar()</a></code> by default uses
<code>stat = "count"</code>, which doesn’t work with two dimensions.
This is a statistical transformation that counts the number of unique
values in a column, so it really only works when you have a single
dimension, for example in a barplot representing a histogram:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/geom%203-1.png" width="700"></p>
<p>However, some geoms with <code>stat</code> transformations other than
<code>identity</code> can work very neatly with two dimensions. For
example, if we want to add a trend line to our scatterplot, we can use
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code>, which shows the central tendency
and confidence intervals of the y variable along the range of the x
axis. Sounds complicated, but really - it’s just the output of a model
where y is predicted by x:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/smooth%201-1.png" width="700"></p>
<p>By default, <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> fits a non-linear
model (either <code>loess</code> or <code>gam</code> depending on the
sample size of the data), but we can constrain it to show a linear
regression - which means we have now created a scatterplot with a trend
line from a linear model of the form <code>y ~ x</code>. We could
construct this model by running
<code>lm(Petal.Length ~ Sepal.Length, data = iris)</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/smooth%202-1.png" width="700"></p>
<p>An important thing to note here - each <code>geom_*()</code> function
defines a <strong>new layer</strong>. This means we can potentially use
different aesthetic mappings, or even different data, for a new geom. To
explore what that means, we’ll start by assigning an aesthetic mapping
to colour:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%201-1.png" width="700"></p>
<p>We’ve now mapped the colour aesthetic onto the column Species, so
that each unique value of Species gets its own colour. This applies to
all geoms, because we passed the colour aesthetic to the
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> function. Hence, we get three different
regression lines, because by mapping colour to a discrete variable, we
have also implicitly passed a grouping variable - <em>i.e.</em>, the
statistical transformation underlying
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> is applied separately to each
group.</p>
<p>However, we could also map the aesthetic variable to a single layer,
by passing it to only one <code>geom_*()</code> and not the other:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%202-1.png" width="700"></p>
<p>One important thing to note here is that unlike in the previous plot,
the regression line is shared. This is because the colour aesthetic
mapping is not passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code>, and so it
doesn’t include a grouping variable in the statistical transformation.
You can pass it separately to <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> using
the <code>group</code> aesthetic mapping, so that you still get separate
regression lines but without individual colours:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%203-1.png" width="700"></p>
<p>This is just an example of the strength of the layered structure of
<code>ggplot2</code>. By changing the aesthetic mappings and even data
arguments of different layers, you can plot your data in many
interesting ways.</p>
<p>For more expert <code>ggplot2</code> users, you can use
<code>geom_*()</code> in unconventional ways for more complex data vis
by changing the <code>stat</code> value, or by passing a
<code>stat_*()</code> function and adjusting its <code>geom</code>
argument. This is beyond the scope of this tutorial, but feel free to
experiment if you’re interested.</p>
<p>Finally, there is the matter of the position. Just as with
statistical transformations, each <code>geom_*()</code> function comes
with its own default <code>position</code> argument. We won’t get into
it here, but know that this can be a very useful tool for some
visualisations by nudging components to the sides or overlapping them -
and this can be especially important for plots like boxplots or
barplots.</p>
<p>At this point, we have everything we need to create a simple plot.
But there’s a lot more we can do by adjusting the next four layers in
our grammar of graphics cake.</p>
</div>
<div class="section level3">
<h3 id="scales">4. Scales<a class="anchor" aria-label="anchor" href="#scales"></a>
</h3>
<p>The Scales component refers to scaling values in the plot, or using
specific scales to represent multiple values or a range. One basic usage
is to make changes to our axes. Scale functions are patterned as
<code>scale_{aesthetic}_{type}()</code>, where <code>{aesthetic}</code>
is one of the pairings made in the mapping part of a plot. So if we want
restrict the range of values by setting new limits on the axis:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%201-1.png" width="700"></p>
<p><strong>Important:</strong> <em>note the warnings! Data have been
removed, which changes the statistical transformation and also drops an
entire species from the plot! We’ll get into what this means when we get
to discussing coordinate systems.</em></p>
<p>We could also use the <code>scale_*()</code> function to transform
the axis. For example, if we want to log an axis:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>transform <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%202-1.png" width="700"></p>
<p>Another good use - we can rename a dimension using the
<code>scale_*()</code> function. Like this:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"New name"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%203-1.png" width="700"></p>
<p>Note the distinction between discrete and continuous types, the third
element in <code>scale_{aesthetic}_{type}()</code>. If a discrete
variable is mapped to one your axes you can only transform it using
<code>scale_{aesthetic}_discrete()</code>. Attempting to use
<code>scale_{aesthetic}_continuous()</code> like in the previous example
will generate an error:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `scale_x_continuous()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Discrete values supplied to continuous scale.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Example values: <span style="color: #0000BB;">setosa</span>, <span style="color: #0000BB;">setosa</span>, <span style="color: #0000BB;">setosa</span>, <span style="color: #0000BB;">setosa</span>, and <span style="color: #0000BB;">setosa</span></span></span></code></pre></div>
<p>Finally, we can use <code>scale_*()</code> functions to assign new
representations to aesthetic mappings other than the axes. For instance,
we can use <code>scale_*()</code> functions to change the size, shape or
colour values used to represent specific values of the underlying data.
For a colour scale, that means we can assign different colours to the
mapped groups:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"purple"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%204-1.png" width="700"></p>
<p>Or, we can use our Cesar Australia colour palettes by using one of
the custom functions included with <strong>seizer</strong>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_colour_cesar_d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%205-1.png" width="700"></p>
<p>Note we use <code><a href="../reference/scale_cesar.html">scale_colour_cesar_d()</a></code> for a discrete colour
palette, because colour is mapped to a character variable. If we map
colour to a continuous variable, such as sepal width, we need to use the
appropriate function, <code><a href="../reference/scale_cesar.html">scale_colour_cesar_c()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_colour_cesar_c</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"galliano_c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation:</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">colour</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%206-1.png" width="700"></p>
<p>Mind the warning that popped up - this refers to the
<code>colour</code> aesthetic being dropped from
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> because it is meaningless to assign
a continuous colour mapping to this geom.</p>
<p>One important thing to note - you cannot include more than one colour
scale*. However, there is another aesthetic mapping which assigns
colours - fill. The difference between them is that <code>colour</code>
refers to outlines, and <code>fill</code> to, well, fills. Some geoms do
not have <code>fill</code> values - for example lines, or points, which
are all one dimnensional. But some do - for example, polygons like the
confidence intervals around our <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code>. So,
we can assign Species to <code>fill</code> to have colour-coded species
while also assigning colours to different values of our third variable,
sepal width.</p>
<p><font size="1">* unless you use the <a href="https://eliocamp.github.io/ggnewscale/" class="external-link">ggnewscale</a>
package</font></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Sepal.Width</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_colour_cesar_c</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"galliano_c"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_fill_cesar_d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation:</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">colour</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%207-1.png" width="700"></p>
<p>To truly see the difference between <code>colour</code> and
<code>fill</code> it is best to look at a <code>geom</code> that has
both. Compare this:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%208-1.png" width="700"></p>
<p>To this:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%209-1.png" width="700"></p>
<p>One final note about colour - we can also assign colours to geoms
without mapping them to variables. For example, if we just want to
change the colour of the lines so they’re not blue, we can do this by
assigning a value to the <code>colour</code> argument of
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> <em>outside</em> of the
<code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code> function (in this example we use
<code>ancient_lavastone</code>, which is a colour included with the
<strong>seizer</strong> package):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Sepal.Width</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">ancient_lavastone</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_colour_cesar_c</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"galliano_c"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_fill_cesar_d</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/scale%20colour%2010-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="facets">5. Facets<a class="anchor" aria-label="anchor" href="#facets"></a>
</h3>
<p>Ok, we’re starting to get close to the final product. We will now
discuss facets, which are a way of dividing our plot to subplots by
using subsets of the data, defined by variables of a given column.
<code>ggplot2::facet_*()</code> functions can accept a mapping of
variables as a formula of the form <code>y ~ x</code> where
<code>y</code> represents the variable coded to rows (each value is
displayed in a separate row), and <code>x</code> the variable coded to
columns (each value is displayed in a separate column). We can omit
either <code>y</code> or <code>x</code> if we just want subplots across
columns or rows, respectively. For example, if we want to divide our
plot into a subplot for each species next to one another (separate
columns):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Species</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/facets%201-1.png" width="700"></p>
<p>Note that all three facets have shared ranges on their axes. This can
sometimes be useful, if you want to easily compare one group to another.
In other cases, it may be informative - for instance, if the range of
values in one group is so large that the variation in another is masked
by it. We can sort of see something like that happen with the species
<em>setosa</em>, where most of the subplot is empty space. We can get
around this using the <code>scales</code> argument in the
<code>facet_*()</code> function. We can free up one or both of the axes
by passing <code>scales = "free_x"</code>,
<code>scales = "free_y"</code> or <code>scales = "free"</code>, which
essentially changes the scale parameters of individual facets based on
the data range for the group in the data subset:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Species</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/facets%202-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="coordinates">6. Coordinates<a class="anchor" aria-label="anchor" href="#coordinates"></a>
</h3>
<p>The final component is the coordinate system. These define how your
position aesthetics (x and y) are interpreted and displayed. You
basically have two options* here - Cartesian (the default), and polar.
Basically, Cartesian coordinate system is where your x and y axes are
perpendicular. In a polar system, each point is defined by a radial
coordinate (distance from the centre) and an angular coordinate (or
azimuth). Sometimes data vis will require polar coordinates
(<em>e.g.</em>, pie chart), but you will likely never have to worry
about it. But if you want to see what happens when you use a polar
coordinate system in <code>ggplot2</code>:</p>
<p><font size="1">* unless you’re creating maps, in which case <a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a>
gets into the picture</font></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/polar-1.png" width="700"></p>
<p>Looks cool eh? Pretty nonsensical from a data vis perspective, but we
can see what happened here - Petal.Length has become the axis along the
radius (radial coordinate) and Sepal.Length has become the azimuth
(angular coordinate).</p>
<p>Anyway, the main use you will get from playing with coordinates is if
you want to zoom in on particular parts of the data. Remember when we
changed the limits in our axis scale? Here it is again:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/cartesian%201-1.png" width="700"></p>
<p>Here’s what happens if you do something similar using the function
<code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">ggplot2::coord_cartesian()</a></code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/cartesian%202-1.png" width="700"></p>
<p>See the difference in the green line? This goes back to those
warnings we mentioned when changing the range of the axis using a
<code>scale_*()</code> function. <code>scale</code> is a transformation.
You’re telling <code>ggplot2</code> to only consider data within the
range defined by the <code>scale_*()</code> function - so the regression
function underlying <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> only uses data
within that range to calculate the trend line. Coordinates, however,
only change how the data are displayed, not how anything is calculated.
So this gives us a real zoom in, without actually changing any of the
data underlying the plot.</p>
</div>
<div class="section level3">
<h3 id="theme">7. Theme<a class="anchor" aria-label="anchor" href="#theme"></a>
</h3>
<p>This is another important way to play around with
<code>ggplot2</code> objects. <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> controls all
of the static elements of a plot - basically anything to do with how it
looks that isn’t controlled by the underlying data. This can be things
like font size of labels, width of grid lines, background colour, etc.
For example, if you want to get rid of a legend it’s as simple as
running:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/legend-1.png" width="700"></p>
<p>This is actually an important component of data vis, since this can
have a large impact on how visually appealing and neat your plot looks.
Otherwise good data vis can fail if the plot comes out looking too
cluttered, and the static elements can have a lot to do with this. From
a company or team perspective, this can also be where you standardise
your plots to a distinct visual style that reinforces your brand
identity. Unfortunately, while powerful and important,
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> is also very complicated. There are
<strong>a lot</strong> of parts you can customise. So, to save you the
trouble, <strong>seizer</strong> comes with its own, inbuilt
<code><a href="../reference/theme_cesar.html">theme_cesar()</a></code> function which makes your figure look nice
and tidy and in line with the Cesar Australia style guide!</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_cesar.html">theme_cesar</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/theme-1.png" width="700"></p>
<p>We’ve almost recreated our figure. The one thing we’re missing is
labels - and while you can change those using <code>scale_*()</code> or
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> functions, you can also use the handy
<code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggplot2::labs()</a></code> function. Note that you can use this to add
titles and susbtitles, but also to change the names of existing axes
and/or aesthetic mappings.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"This is a title"</span>, subtitle <span class="op">=</span> <span class="st">"This is a subtitle"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="ggplot2-tutorial_files/figure-html/labs-1.png" width="700"></p>
<p>So there we go! We have now successfully recreated the figure, using
all of our distinct stages, apart from Coordinates which we leave at
default values:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="co"># 1. Data</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span>, colour <span class="op">=</span> <span class="va">Sepal.Width</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 2. Mapping</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">ancient_lavastone</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 3. Layers</span></span>
<span>  <span class="fu"><a href="../reference/scale_cesar.html">scale_colour_cesar_c</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"galliano_c"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_cesar.html">scale_fill_cesar_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 4. Scales</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Species</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 5. Facets</span></span>
<span>  <span class="fu"><a href="../reference/theme_cesar.html">theme_cesar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 7. Theme</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"This is a title"</span>, subtitle <span class="op">=</span> <span class="st">"This is a subtitle"</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>Well done! You are now well versed in the basics of
<code>ggplot2</code> and should be able to build your own plots from
scratch. However, if you feel like you need more help, or just want to
delve deeper, you can explore the following resources:</p>
<p><a href="https://ggplot2.tidyverse.org/articles/ggplot2.html" class="external-link">ggplot2: Get
started</a></p>
<p><a href="https://r-statistics.co/Complete-Ggplot2-Tutorial-Part1-With-R-Code.html" class="external-link">The
Complete ggplot2 Tutorial</a></p>
<p><a href="https://vita.had.co.nz/papers/layered-grammar.html" class="external-link">A
layered grammar of graphics</a></p>
<p><a href="https://towardsdatascience.com/a-comprehensive-guide-to-the-grammar-of-graphics-for-effective-visualization-of-multi-dimensional-1f92b4ed4149" class="external-link">A
Comprehensive Guide to the Grammar of Graphics for Effective
Visualization of Multi-dimensional Data</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Slavenko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
